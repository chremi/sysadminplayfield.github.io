<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" ><generator uri="https://jekyllrb.com/" version="4.0.0">Jekyll</generator><link href="http://localhost:4000/feed.xml" rel="self" type="application/atom+xml" /><link href="http://localhost:4000/" rel="alternate" type="text/html" /><updated>2020-02-24T11:53:05-06:00</updated><id>http://localhost:4000/feed.xml</id><title type="html">SysAdmin Playfield</title><subtitle>Short Linux tutorials for RHEL/CentOS</subtitle><entry><title type="html">RHCSA Certification - Part1 - Reset root password</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-01-reset-root-password.html" rel="alternate" type="text/html" title="RHCSA Certification - Part1 - Reset root password" /><published>2020-02-20T23:00:40-06:00</published><updated>2020-02-20T23:00:40-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-01-reset-root-password</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-01-reset-root-password.html">&lt;p&gt;If the root password is lost, you need to interrupt the boot process and gain access to a chrooted environment.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
At &lt;strong&gt;grub2&lt;/strong&gt; screen, press “&lt;strong&gt;e&lt;/strong&gt;” to &lt;strong&gt;edit&lt;/strong&gt; the configuration.&lt;br /&gt;
At the end of the line starting with “&lt;strong&gt;linux16&lt;/strong&gt;”, append the following:&lt;/p&gt;

&lt;pre&gt;
&lt;b&gt;[...]&lt;/b&gt;
linux16 /vmlinuz-3.10.0-123.el7.x86_64 root=UUID=[...] ro rd.lvm.lv=centos/swap \  
vconsole.font=latarcyrheb-sun16 rd.lvm.lv=centos/root crashkernel=auto vconsole.keymap=us \  
rhgb quiet LANG=en_US.UTF-8 &lt;b&gt;rd.break enforcing=0&lt;/b&gt;
&lt;b&gt;[...]&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;“&lt;strong&gt;rd.break&lt;/strong&gt;” interrupts the boot process.&lt;br /&gt;
“&lt;strong&gt;enforcing=0&lt;/strong&gt;” sets temporarily SELinux to “Permissive”.&lt;/p&gt;

&lt;p&gt;Proceed with &lt;strong&gt;Ctrl+x&lt;/strong&gt; to continue the boot process with the new configuration.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;Mount&lt;/strong&gt; the /sysroot folder with &lt;strong&gt;read&lt;/strong&gt; and &lt;strong&gt;write&lt;/strong&gt; access, and change root (&lt;strong&gt;chroot&lt;/strong&gt;) to set the new root password:&lt;/p&gt;

&lt;pre&gt;
switch_root:/# &lt;b&gt;mount -o rw,remount /sysroot&lt;/b&gt;
switch_root:/# &lt;b&gt;chroot /sysroot&lt;/b&gt;
sh-4.2# &lt;b&gt;passwd&lt;/b&gt;
	Enter new root password:.....
	Confirm new root password:.....
sh-4.2# &lt;b&gt;exit&lt;/b&gt;
switch_root:/# &lt;b&gt;logout&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;
The boot process is finished.&lt;br /&gt;
Log in as root with the new password, and reset the SELinux context of /etc/shadow :&lt;/p&gt;

&lt;pre&gt;
root@localhost# &lt;b&gt;restorecon -v /etc/shadow&lt;/b&gt;
root@localhost# &lt;b&gt;reboot&lt;/b&gt;
&lt;/pre&gt;</content><author><name></name></author><summary type="html">If the root password is lost, you need to interrupt the boot process and gain access to a chrooted environment.</summary></entry><entry><title type="html">RHCSA Certification - Part2 - Configure network interface</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-02-configure-netowrk-interface-nmcli.html" rel="alternate" type="text/html" title="RHCSA Certification - Part2 - Configure network interface" /><published>2020-02-20T22:00:01-06:00</published><updated>2020-02-20T22:00:01-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-02-configure-netowrk-interface-nmcli</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-02-configure-netowrk-interface-nmcli.html">&lt;p&gt;We assume the following:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;OS: CentOS 7.0&lt;/li&gt;
  &lt;li&gt;Static IP address: 192.168.2.100/24&lt;/li&gt;
  &lt;li&gt;Gateway: 192.168.2.200 (you can also choose a public DNS server such as google 8.8.8.8)&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;
Although it is still possible to manually edit the network configuration files in &lt;code class=&quot;highlighter-rouge&quot;&gt;/etc/sysconfig/network-scripts&lt;/code&gt; directory, this is not the preferred way anymore.&lt;br /&gt;
If you still wish to manually modify the files, do not forget to execute &lt;code class=&quot;highlighter-rouge&quot;&gt;nmcli con reload&lt;/code&gt; to update changes.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Let’s start the configuration:&lt;/p&gt;

&lt;p&gt;Display network configurations with &lt;strong&gt;nmcli&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli c s
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If the command doesn’t display any connection and you don’t know the name of the interface, use &lt;code class=&quot;highlighter-rouge&quot;&gt;ip a&lt;/code&gt; to get it.&lt;/p&gt;

&lt;p&gt;Create the new connection:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# nmcli con add type ethernet ifname eth0 con-name eth0
# nmcli con mod eth0 ipv4.addresses &quot;192.168.2.100/24 192.168.2.1&quot; \
 			ipv4.dns 192.168.2.200 \
 			ipv4.method manual \
 			connection.autoconnect yes
# nmcli con up eth0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Test the new connection:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ping -I eth0 192.168.2.200
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">We assume the following: OS: CentOS 7.0 Static IP address: 192.168.2.100/24 Gateway: 192.168.2.200 (you can also choose a public DNS server such as google 8.8.8.8)</summary></entry><entry><title type="html">RHCSA Certification - Part3 - systemd targets</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-03-systemd-targets.html" rel="alternate" type="text/html" title="RHCSA Certification - Part3 - systemd targets" /><published>2020-02-20T20:00:01-06:00</published><updated>2020-02-20T20:00:01-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-03-systemd-targets</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-03-systemd-targets.html">&lt;p&gt;With &lt;strong&gt;SystemV&lt;/strong&gt;, we talked about &lt;strong&gt;runlevels&lt;/strong&gt;.&lt;br /&gt;
With &lt;strong&gt;systemd&lt;/strong&gt;, we talk about &lt;strong&gt;targets&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;Relationship between runlevels and targets:&lt;/p&gt;

&lt;pre&gt;
&lt;b&gt;Runlevel		Target				Description&lt;/b&gt;
0	runlevel0.target, poweroff.target	Power off
1	runlevel1.target, rescue.target		Non-graphical single-user
2,3,4	runlevel[234].target, multi-user.target	Non-graphical multi-user
5 	runlevel5.target, graphical.target	Graphical multi-user
6 	runlevel6.target, reboot.target		Reboot
&lt;/pre&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;Check&lt;/strong&gt; the system’s current &lt;strong&gt;default target&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; # systemctl get-default
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Set&lt;/strong&gt; the &lt;strong&gt;default target&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; # systemctl set-default multi-user.target
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you wish to &lt;strong&gt;switch immediately&lt;/strong&gt; to &lt;strong&gt;rescue.target&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; # systemctl isolate rescue
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">With SystemV, we talked about runlevels. With systemd, we talk about targets.</summary></entry><entry><title type="html">RHCSA Certification - Part4 - SELinux</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-04-selinux.html" rel="alternate" type="text/html" title="RHCSA Certification - Part4 - SELinux" /><published>2020-02-20T17:30:40-06:00</published><updated>2020-02-20T17:30:40-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-04-selinux</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-04-selinux.html">&lt;p&gt;&lt;strong&gt;SElinux&lt;/strong&gt; configuration file is &lt;strong&gt;/etc/selinux/config&lt;/strong&gt;.&lt;br /&gt;
In this file you can set the default configuration such as the mode (&lt;strong&gt;enforcing&lt;/strong&gt;, &lt;strong&gt;permissive&lt;/strong&gt;, &lt;strong&gt;disabled&lt;/strong&gt;) and the protection type (&lt;strong&gt;targeted&lt;/strong&gt;, &lt;strong&gt;minimum&lt;/strong&gt;, &lt;strong&gt;mls&lt;/strong&gt;)&lt;/p&gt;

&lt;p&gt;When enabled, SELinux can be in Permissive mode or Enforcing mode.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Check current mode for SELinux:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; # getenforce
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If SELinux current mode is “Enforcing”, you can &lt;strong&gt;temporarily&lt;/strong&gt; set it to “&lt;strong&gt;Permissive&lt;/strong&gt;”:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; # setenforce permissive
or
 # setenforce 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Or else, if it is set to “Permissive” and you want to &lt;strong&gt;temporarily&lt;/strong&gt; set it to “&lt;strong&gt;Enforcing&lt;/strong&gt;”:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt; # setenforce enforcing
or
 # setenforce 1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
If SELinux is disabled, &lt;code class=&quot;highlighter-rouge&quot;&gt;setenforce&lt;/code&gt; will not work because it requires relabeling the whole filesystem. You can force a relabel with the following command:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;touch /.autorelabel
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To &lt;strong&gt;permanently&lt;/strong&gt; set an SELinux mode (&lt;strong&gt;persists across reboots&lt;/strong&gt;), &lt;strong&gt;edit&lt;/strong&gt; the configuration file &lt;strong&gt;/etc/selinux/config&lt;/strong&gt;.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;SEMANAGE&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;semanage&lt;/strong&gt; tool is not present in the minimal install of CentOS 7, we need to install it.&lt;/p&gt;

&lt;p&gt;If you can’t remember what package provides &lt;strong&gt;semanage&lt;/strong&gt; tool, and let’s install it:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;yum provides */semanage&lt;/b&gt;
    [...]
    policycoreutils-python
    setroubleshoot-server
    [...]
&lt;/pre&gt;

&lt;p&gt;You can install either &lt;strong&gt;setroubleshoot-server&lt;/strong&gt; or &lt;strong&gt;policycoreutils-python&lt;/strong&gt;&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install -y setroubleshoot-server
or
# yum install -y policycoreutils-python
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CONTEXTS ON FILES/DIRECTORIES&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;List&lt;/strong&gt; available contexts for admin_home:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# semanage fcontext -l | grep admin_home
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Retreive SELinux context&lt;/strong&gt; for /root folder using ls with &lt;strong&gt;-Z&lt;/strong&gt; option:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# ls -ldZ /root
    dr-xr-x---. root root system-u:object_r:admin_home_t:s0 /root
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Create &lt;code class=&quot;highlighter-rouge&quot;&gt;/custom_home&lt;/code&gt; folder, and &lt;strong&gt;set&lt;/strong&gt; “&lt;strong&gt;admin_home_t&lt;/strong&gt;” &lt;strong&gt;context&lt;/strong&gt; on it using &lt;strong&gt;semanage&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir /custom_home
# semanage fcontext -a -t admin_home_t &quot;/custom_home(/.*)?&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Apply/Update&lt;/strong&gt; the new &lt;strong&gt;context&lt;/strong&gt; (-v option is for verbose) and check:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# restorecon -v /custom_home
# ls -ldZ /custom_home
    dr-xr-x---. root root unconfined_u:object_r:admin_home_t:s0 /custom_home
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CONTEXTS ON PORTS&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;List&lt;/strong&gt; available contexts for ssh:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;semanage port -l | grep ssh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Allow&lt;/strong&gt; listening on an &lt;strong&gt;unconventional&lt;/strong&gt; &lt;strong&gt;port&lt;/strong&gt; for ssh in SELinux:&lt;/p&gt;

&lt;pre&gt;
&lt;b&gt;Add context&lt;/b&gt; on a port:
# semanage port -&lt;b&gt;a&lt;/b&gt;t ssh_port_t 2222 -p tcp

or, if you need to &lt;b&gt;modify&lt;/b&gt; the &lt;b&gt;default context&lt;/b&gt;:
# semanage port -&lt;b&gt;m&lt;/b&gt;t ssh_port_t 2222 -p tcp

or, if you need to &lt;b&gt;delete&lt;/b&gt; the &lt;b&gt;context&lt;/b&gt;:
# semanage port -&lt;b&gt;d&lt;/b&gt;t ssh_port_t 2222 -p tcp
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Edit&lt;/strong&gt; &lt;strong&gt;/etc/ssh/sshd_config&lt;/strong&gt; to add listening on &lt;strong&gt;port 2222&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;vi /etc/ssh/sshd_config&lt;/b&gt;
	[...]
	Port 22
	&lt;b&gt;Port 2222&lt;/b&gt;
	[...]
	&lt;b&gt;PermitRootLogin yes&lt;/b&gt;
	[...]
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Restart sshd&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl restart sshd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Allow&lt;/strong&gt; access in &lt;strong&gt;firewalld&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-port=2222/tcp
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;BOOLEANS&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;List&lt;/strong&gt; all &lt;strong&gt;selinux booleans&lt;/strong&gt; related to nfs:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# getsebool -a | grep httpd
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Enable **temporarily&lt;/strong&gt; a &lt;strong&gt;boolean&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# setsebool httpd_can_sendmail on
or
# setsebool httpd_can_sendmail 1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Disable&lt;/strong&gt; &lt;strong&gt;temporarily&lt;/strong&gt; a &lt;strong&gt;boolean&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# setsebool httpd_can_sendmail off
or
# setsebool httpd_can_sendmail 0
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Enable&lt;/strong&gt; &lt;strong&gt;permanently&lt;/strong&gt; a &lt;strong&gt;boolean&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# setsebool -P httpd_can_sendmail on
or
# setsebool -P httpd_can_sendmail 1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">SElinux configuration file is /etc/selinux/config. In this file you can set the default configuration such as the mode (enforcing, permissive, disabled) and the protection type (targeted, minimum, mls)</summary></entry><entry><title type="html">RHCSA Certification - Part5 - Redirections, STD{IN,OUT,ERR}, |, ||, &amp;amp;&amp;amp;</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-05-redirection-piping.html" rel="alternate" type="text/html" title="RHCSA Certification - Part5 - Redirections, STD{IN,OUT,ERR}, |, ||, &amp;&amp;" /><published>2020-02-20T17:00:00-06:00</published><updated>2020-02-20T17:00:00-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-05-redirection-piping</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-05-redirection-piping.html">&lt;p&gt;stdin: &amp;lt; : code 0 : Standard input&lt;br /&gt;
stdout: &amp;gt; : code 1 : Standard output&lt;br /&gt;
stderr: 2&amp;gt; : code 2 : Standard error&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;|&lt;/code&gt; : redirects the output of a command to another command &lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;gt;&amp;gt;&lt;/code&gt; : append to a file&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;||&lt;/code&gt; : logical OR (if the 1st command fails, do the 2nd anyway)&lt;br /&gt;
&lt;code class=&quot;highlighter-rouge&quot;&gt;&amp;amp;&amp;amp;&lt;/code&gt; : logical AND (if the 1st command fails, stop)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Redirect stdout&lt;/strong&gt; to a file (stderr will be displayed on screen and ):&lt;/p&gt;

&lt;pre&gt;
# find /var/log -perm 0755 &lt;b&gt;&amp;gt;&lt;/b&gt; /root/perms.txt
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Redirect stderr&lt;/strong&gt; to a file (stdout will be displayed on screen):&lt;/p&gt;

&lt;pre&gt;
# find /var/log -perm 0755 &lt;b&gt;2&amp;gt;&lt;/b&gt; /root/perms.txt
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Redirect stderr&lt;/strong&gt; to the target of &lt;strong&gt;stdout&lt;/strong&gt; (here, a file called /root/perms.txt):&lt;/p&gt;

&lt;pre&gt;
# find /var/log -perm 0755 &lt;b&gt;&amp;gt;&lt;/b&gt; /root/perms.txt &lt;b&gt;2&amp;gt;&amp;amp;1&lt;/b&gt;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Redirect&lt;/strong&gt; the &lt;strong&gt;echo&lt;/strong&gt; command &lt;strong&gt;to&lt;/strong&gt; a &lt;strong&gt;file&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
# echo &quot;test&quot; &lt;b&gt;&amp;gt;&lt;/b&gt; /root/testfile
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Append&lt;/strong&gt; text to a file:&lt;/p&gt;

&lt;pre&gt;
# echo &quot; and 2nd test&quot; &lt;b&gt;&amp;gt;&amp;gt;&lt;/b&gt; /root/testfile
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Redirect to stdin&lt;/strong&gt; (here, the screen):&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;&amp;lt;&lt;/b&gt; testfile
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Complex&lt;/strong&gt; command to send a &lt;strong&gt;string&lt;/strong&gt; and attach a file to an mail, and confirm if the command successfully exited:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# echo &quot;Hi&quot; | mailx -s &quot;Re: requested file&quot; root &amp;lt; testfile | if [ $? -eq 0 ]; then; echo &quot;Mail has been sent&quot;; else; echo &quot;Error&quot;; fi
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;Usage&lt;/strong&gt; for &lt;b&gt;||&lt;/b&gt; and &lt;b&gt;&amp;amp;&amp;amp;&lt;/b&gt;:&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt; for logical &lt;strong&gt;OR&lt;/strong&gt;:&lt;/p&gt;

&lt;pre&gt;
rm -Rf somedir &lt;b&gt;||&lt;/b&gt; exit_on_error &quot;Failed to remove the directory&quot;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt; for logical &lt;strong&gt;AND&lt;/strong&gt; (excludes 2nd part if the first fails):&lt;/p&gt;

&lt;pre&gt;
rm -Rf somedir &lt;b&gt;&amp;amp;&amp;amp;&lt;/b&gt; trace_output &quot;Removed the directory&quot;
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Example&lt;/strong&gt; for both logical &lt;strong&gt;AND&lt;/strong&gt; and &lt;strong&gt;OR&lt;/strong&gt;:&lt;/p&gt;
&lt;pre&gt;
mailx -s &quot;Re: requested file&quot; root &lt;b&gt;&amp;lt;&lt;/b&gt; testfile &lt;b&gt;&amp;amp;&amp;amp;&lt;/b&gt; echo &quot;Mail has been sent&quot; &lt;b&gt;||&lt;/b&gt; echo &quot;Error&quot;
&lt;/pre&gt;

&lt;pre&gt;
rm -Rf somedir &lt;b&gt;&amp;amp;&amp;amp;&lt;/b&gt; trace_output &quot;Removed the directory&quot; &lt;b&gt;||&lt;/b&gt; exit_on_error &quot;Failed to remove the directory&quot;
&lt;/pre&gt;</content><author><name></name></author><summary type="html">stdin: &amp;lt; : code 0 : Standard input stdout: &amp;gt; : code 1 : Standard output stderr: 2&amp;gt; : code 2 : Standard error | : redirects the output of a command to another command &amp;gt;&amp;gt; : append to a file || : logical OR (if the 1st command fails, do the 2nd anyway) &amp;amp;&amp;amp; : logical AND (if the 1st command fails, stop)</summary></entry><entry><title type="html">RHCSA Certification - Part6 - Firewalld</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-06-firewalld.html" rel="alternate" type="text/html" title="RHCSA Certification - Part6 - Firewalld" /><published>2020-02-20T16:30:00-06:00</published><updated>2020-02-20T16:30:00-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-06-firewalld</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-06-firewalld.html">&lt;p&gt;&lt;strong&gt;Verify&lt;/strong&gt; if firewalld is &lt;strong&gt;active&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --state
running
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Start&lt;/strong&gt; firewalld:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl start firewalld.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Set firewalld to &lt;strong&gt;start&lt;/strong&gt; automatically &lt;strong&gt;at boot&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl enable firewalld.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Set the firewall &lt;strong&gt;default zone&lt;/strong&gt; (Default is Public zone. Common zones are: internal, external, home, dmz, trusted, drop, etc. …):&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --set-default-zone=dmz
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Allow temporarily&lt;/strong&gt; a service to the default zone:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --add-service=ssh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Allow permanently&lt;/strong&gt; a service to the default zone:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-service=ssh
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Remove temporarily&lt;/strong&gt; a service to the default zone:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --remove-service=ssh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Remove permanently&lt;/strong&gt; a service to the default zone:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --remove-service=ssh
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Add&lt;/strong&gt; a &lt;strong&gt;port&lt;/strong&gt; to a specific &lt;strong&gt;zone&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --zone=dmz --add-port=8080/tcp
# firewall-cmd --permanent
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; a &lt;strong&gt;rich rules&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-rich-rule 'rule family=ipv4 source address=192.168.2.2 port port=80 protocol=tcp accept'
# firewall-cmd --permanent --add-rich-rule 'rule service name=ssh log prefix=&quot;SSH_&quot; level=debug limit value=2/m reject'
#firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Add&lt;/strong&gt; a &lt;strong&gt;port forwarding&lt;/strong&gt; to the default zone:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-masquerade
# firewall-cmd --permanent --add-forward-port=port=21:proto=tcp:toport=80:toaddr=192.168.2.3
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">Verify if firewalld is active:</summary></entry><entry><title type="html">RHCSA Certification - Part7 - The $PS1 variable</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-07-ps1-prompt.html" rel="alternate" type="text/html" title="RHCSA Certification - Part7 - The $PS1 variable" /><published>2020-02-20T16:00:00-06:00</published><updated>2020-02-20T16:00:00-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-07-ps1-prompt</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-07-ps1-prompt.html">&lt;p&gt;The &lt;strong&gt;PS1 variable&lt;/strong&gt; defines what your &lt;strong&gt;primary prompt&lt;/strong&gt; looks like (in general, the primary prompt is &lt;strong&gt;bash&lt;/strong&gt; – Bourne Again SHell)&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Display&lt;/strong&gt; your system’s &lt;strong&gt;PS1 variable&lt;/strong&gt; using the &lt;strong&gt;echo&lt;/strong&gt; command:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# echo $PS1
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
The &lt;strong&gt;bash manual&lt;/strong&gt; contains some information about how to configure the prompt:&lt;/p&gt;
&lt;ul&gt;
  &lt;li&gt;Display the bash manual using: &lt;code class=&quot;highlighter-rouge&quot;&gt;man bash&lt;/code&gt;&lt;/li&gt;
  &lt;li&gt;Type &lt;code class=&quot;highlighter-rouge&quot;&gt;/PROMPTING&lt;/code&gt; to start a forward search&lt;/li&gt;
  &lt;li&gt;Press &lt;strong&gt;n&lt;/strong&gt; twice&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;PS1 variable&lt;/strong&gt; most useful &lt;strong&gt;options&lt;/strong&gt;:&lt;br /&gt;
&lt;strong&gt;\H&lt;/strong&gt; = display &lt;strong&gt;hostname&lt;/strong&gt;&lt;br /&gt;
&lt;strong&gt;\u&lt;/strong&gt; = display &lt;strong&gt;username&lt;/strong&gt;&lt;br /&gt;
&lt;strong&gt;\w&lt;/strong&gt; = display &lt;strong&gt;working directory&lt;/strong&gt;&lt;br /&gt;
&lt;strong&gt;$&lt;/strong&gt; = display “&lt;strong&gt;$&lt;/strong&gt;” for normal user or “&lt;strong&gt;#&lt;/strong&gt;” for root user&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
Change the &lt;strong&gt;$PS1&lt;/strong&gt; variable:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# export PS1=&quot;\H \u \w \$&quot;
# echo $PS1
 PS1=&quot;\H \u \w \$&quot;
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To make the custom prompt &lt;strong&gt;persistent across reboots&lt;/strong&gt;, append to &lt;strong&gt;/root/.bashrc&lt;/strong&gt; or &lt;strong&gt;/home/$user/.bashrc&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# echo 'export PS1=&quot;\H \u \w \$&quot;' &amp;gt;&amp;gt; ~/.bashrc
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">The PS1 variable defines what your primary prompt looks like (in general, the primary prompt is bash – Bourne Again SHell)</summary></entry><entry><title type="html">RHCSA Certification - Part8 - User/group management and basic permissions</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-08-user-group-chage-passwd.html" rel="alternate" type="text/html" title="RHCSA Certification - Part8 - User/group management and basic permissions" /><published>2020-02-20T15:30:00-06:00</published><updated>2020-02-20T15:30:00-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-08-user-group-chage-passwd</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-08-user-group-chage-passwd.html">&lt;p&gt;It is easy to create a user with useradd, but if you have to create multiple user accounts, it is much more convenient to do it with a bash script that will loop the command for you.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;USERADD&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Usage: &lt;code class=&quot;highlighter-rouge&quot;&gt;useradd [options] &amp;lt;user_name&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Important options:&lt;br /&gt;
 &lt;strong&gt;-D&lt;/strong&gt; : &lt;strong&gt;defaults&lt;/strong&gt; (can be altered with additional options)&lt;br /&gt;
 &lt;strong&gt;-m&lt;/strong&gt; : &lt;strong&gt;create home directory&lt;/strong&gt; if it doesn’t exist &lt;br /&gt;
 &lt;strong&gt;-s&lt;/strong&gt; : &lt;strong&gt;shell&lt;/strong&gt; (/bin/bash, /sbin/nologin, etc. …)  &lt;br /&gt;
 &lt;strong&gt;-e&lt;/strong&gt; : &lt;strong&gt;expire date&lt;/strong&gt; with format YYYY-MM-DD&lt;br /&gt;
 &lt;strong&gt;-f&lt;/strong&gt; : &lt;strong&gt;inactive&lt;/strong&gt; after creation&lt;br /&gt;
 &lt;strong&gt;-g&lt;/strong&gt; : manual &lt;strong&gt;gid&lt;/strong&gt; number&lt;br /&gt;
 &lt;strong&gt;-u&lt;/strong&gt; : manual &lt;strong&gt;uid&lt;/strong&gt; number&lt;br /&gt;
 &lt;strong&gt;-G&lt;/strong&gt; : &lt;strong&gt;groups&lt;/strong&gt; (coma separated)&lt;br /&gt;
 &lt;strong&gt;-r&lt;/strong&gt; : &lt;strong&gt;system account&lt;/strong&gt;, doesn’t create home, mail, usergroup…&lt;/p&gt;

&lt;p&gt;More on &lt;code class=&quot;highlighter-rouge&quot;&gt;man useradd&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CHAGE&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Usage: &lt;code class=&quot;highlighter-rouge&quot;&gt;chage [options] &amp;lt;user_name&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;The &lt;strong&gt;-l&lt;/strong&gt; option will &lt;strong&gt;display password aging information&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chage -l alice
# chage -l ben
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;strong&gt;-E&lt;/strong&gt; option will set a &lt;strong&gt;password expiration&lt;/strong&gt; date for the user:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chage -E 2017-12-31 alice
# chage -E 2017-12-31 ben
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;GROUPADD&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Usage: &lt;code class=&quot;highlighter-rouge&quot;&gt;groupadd [options] &amp;lt;group_name&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;Just &lt;strong&gt;create&lt;/strong&gt; the &lt;strong&gt;group&lt;/strong&gt; dba:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# groupadd dba
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;USERMOD&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Usage: &lt;code class=&quot;highlighter-rouge&quot;&gt;usermod [options] &amp;lt;user_name&amp;gt;&lt;/code&gt;
The &lt;strong&gt;-aG&lt;/strong&gt; option &lt;strong&gt;appends group&lt;/strong&gt; (add a supplementary group to the user).&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# usermod -aG dba alice
# usermod -aG dba ben
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CHOWN&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Use &lt;strong&gt;chown&lt;/strong&gt; to &lt;strong&gt;change&lt;/strong&gt; user and/or group &lt;strong&gt;ownership&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chown alice /srv/groupdir
or
# chown alice:dba /srv/groupdir
or
# chown alice: /srv/groupdir
or
# chown :dba /srv/groupdir
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CHGRP&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Use &lt;strong&gt;chgrp&lt;/strong&gt; to &lt;strong&gt;change&lt;/strong&gt; the &lt;strong&gt;group&lt;/strong&gt; on a file or folder:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chgrp /srv/groupdir dba
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CHMOD&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Use &lt;strong&gt;chmod&lt;/strong&gt; to &lt;strong&gt;change permissions&lt;/strong&gt; to &lt;strong&gt;rwx&lt;/strong&gt; (read, write, execute) on &lt;strong&gt;/srv/groupdir&lt;/strong&gt; for owner and group members only:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chmod -R 770 /srv/groupdir
or
# chmod -R ug=rwx,o-rwx /srv/groupdir
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Group collaboration&lt;/strong&gt;:&lt;br /&gt;
&lt;strong&gt;SetGID&lt;/strong&gt;: All files created belong to the group. All the members of the group can create files, edit or remove any files from the group.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chmod 2770 /srv/groupdir
or
# chmod g+s /srv/groupdir
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;SetUID&lt;/strong&gt; is &lt;strong&gt;not recommended&lt;/strong&gt;. Users allowed to &lt;strong&gt;execute&lt;/strong&gt; a program use the &lt;strong&gt;identity&lt;/strong&gt; (and &lt;strong&gt;permissions&lt;/strong&gt;) of the &lt;strong&gt;owner&lt;/strong&gt;.&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chmod 4770 /srv/groupdir/script.sh
or
# chmod u+s /srv/groupdir/script.sh
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;StickyBit&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chmod 1770 /srv/groupdir/myfile
or
# chmod +t /srv/groupdir/myfile
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;StickyBit with SetGID&lt;/strong&gt;:&lt;br /&gt;
StickyBit sets additional permissions on a file. It comes very convenient in case of group collaboration because only the owner can delete its files:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chmod 3770 /srv/groupdir/myfile
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CHATTR&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Change attributes&lt;/strong&gt; on a file, set the file to &lt;strong&gt;immutable&lt;/strong&gt; (even by root):&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chattr +i file
or, to remove
# chattr -i file
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;GPASSWD&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;Usage: &lt;code class=&quot;highlighter-rouge&quot;&gt;gpasswd [option] &amp;lt;user_name&amp;gt; &amp;lt;group_name&amp;gt;&lt;/code&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Remove user&lt;/strong&gt; alice &lt;strong&gt;from&lt;/strong&gt; the dba &lt;strong&gt;group&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# gpasswd -d alice dba
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;USERDEL&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Delete&lt;/strong&gt; a &lt;strong&gt;user&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# userdel alice
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Delete&lt;/strong&gt; a &lt;strong&gt;user&lt;/strong&gt; with its &lt;strong&gt;home directory&lt;/strong&gt; and &lt;strong&gt;mailbox&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# userdel -r ben
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;GROUPDEL&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Delete&lt;/strong&gt; a &lt;strong&gt;group&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# groupdel dba
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;EXAMPLE&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; several &lt;strong&gt;users&lt;/strong&gt; in 1 command:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# for i in user{1,2,3,4,5}; do useradd $i; done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Check&lt;/strong&gt; created &lt;strong&gt;accounts&lt;/strong&gt; in &lt;strong&gt;/etc/passwd&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# tail -5 /etc/passwd
or
# for i in user{1,2,3,4,5}; do id $i; done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Set password&lt;/strong&gt; for all newly created users by redirecting “password” in the &lt;strong&gt;standard input&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# for i in user{1,2,3,4,5}; do echo &quot;password&quot; | passwd $i --stdin; done
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Warning: this is not the safest way to do it!&lt;/strong&gt;&lt;br /&gt;
There are several discussions related to this topic, for example in https://stackoverflow.com/questions/714915/using-the-passwd-command-from-within-a-shell-script&lt;br /&gt;
Also, it may not be ideal to keep this command in the bash history. If you want to run the command without keeping it in history, just add a space at the beginning of the line (works for bash shell, not for zsh).&lt;/p&gt;</content><author><name></name></author><summary type="html">It is easy to create a user with useradd, but if you have to create multiple user accounts, it is much more convenient to do it with a bash script that will loop the command for you.</summary></entry><entry><title type="html">RHCSA Certification - Part9 - ACLs</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-09-ACLs.html" rel="alternate" type="text/html" title="RHCSA Certification - Part9 - ACLs" /><published>2020-02-20T15:00:00-06:00</published><updated>2020-02-20T15:00:00-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-09-ACLs</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-09-ACLs.html">&lt;p&gt;&lt;br /&gt;
Use &lt;strong&gt;chown&lt;/strong&gt; to &lt;strong&gt;change ownership&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# chown alice: /home/alice/testdir
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use &lt;strong&gt;getfacl&lt;/strong&gt; to &lt;strong&gt;retrieve&lt;/strong&gt; the &lt;strong&gt;ACLs&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# getfacl /home/alice/testdir
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use &lt;strong&gt;setfacl&lt;/strong&gt; with &lt;strong&gt;-m&lt;/strong&gt; option to set &lt;strong&gt;standard&lt;/strong&gt; and &lt;strong&gt;default&lt;/strong&gt; ACLs for ben to access testdir subfolder with &lt;strong&gt;read-only&lt;/strong&gt; permissions:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# setfacl -m u:ben:rx /home/alice
# setfacl -m du:ben:rx /home/alice
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Use &lt;strong&gt;setfacl&lt;/strong&gt; with option &lt;strong&gt;-m&lt;/strong&gt; to modify &lt;strong&gt;standard&lt;/strong&gt; and &lt;strong&gt;default&lt;/strong&gt; ACLs in order to provide ben with &lt;strong&gt;read&lt;/strong&gt; and &lt;strong&gt;write&lt;/strong&gt; access:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# setfacl -m u:ben:rwx /home/alice/testdir
# setfacl -m du:ben:rwx /home/alice/testdir
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Check&lt;/strong&gt; newly applied &lt;strong&gt;ACLs&lt;/strong&gt; on folders &lt;strong&gt;/home/alice&lt;/strong&gt; and &lt;strong&gt;/home/alice/testdir&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# getfacl /home/alice
# getfacl /home/alice/testdir
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Real-life &lt;strong&gt;test&lt;/strong&gt; to &lt;strong&gt;check&lt;/strong&gt; new &lt;strong&gt;access rights&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# su - ben
$ touch /home/alice/testdir/testfile
$ echo &quot;this is a write access test&quot; &amp;gt; /home/alice/testdir/testfile
$ cat /home/alice/testdir/testfile
this is a write access test
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">Use chown to change ownership:</summary></entry><entry><title type="html">RHCSA Certification - Part10 - vsftpd, yum custom repository</title><link href="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-10-vsftpd-yum.html" rel="alternate" type="text/html" title="RHCSA Certification - Part10 - vsftpd, yum custom repository" /><published>2020-02-20T14:30:00-06:00</published><updated>2020-02-20T14:30:00-06:00</updated><id>http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-10-vsftpd-yum</id><content type="html" xml:base="http://localhost:4000/rhcsa/centos7/2020/02/20/rhcsa-10-vsftpd-yum.html">&lt;p&gt;Install &lt;strong&gt;vsftpd&lt;/strong&gt; (very secure file transfer protocol daemon) and &lt;strong&gt;createrepo&lt;/strong&gt; (tool to create repositories):&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum install -y vsftpd createrepo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Start vsftpd&lt;/strong&gt; and enable &lt;strong&gt;autostart&lt;/strong&gt; at boot:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# systemctl enable vsftpd.service
# systemctl start vsftpd.service
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Configure &lt;strong&gt;firewalld&lt;/strong&gt; to &lt;strong&gt;allow ftp&lt;/strong&gt; service (default &lt;strong&gt;port 21&lt;/strong&gt;):&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# firewall-cmd --permanent --add-service=ftp
# firewall-cmd --reload
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; the &lt;strong&gt;custom repository&lt;/strong&gt; on the server with &lt;strong&gt;createrepo&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# mkdir /var/ftp/pub/customrepo
# createrepo /var/ftp/pub/customrepo
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;br /&gt;
&lt;strong&gt;CLIENT SETUP&lt;/strong&gt;&lt;/p&gt;

&lt;p&gt;&lt;strong&gt;Create&lt;/strong&gt; a new file: &lt;strong&gt;/etc/yum.repos.d/customrepo.repo&lt;/strong&gt; :&lt;/p&gt;

&lt;pre&gt;
# &lt;b&gt;vi /etc/yum.repos.d/customrepo.repo&lt;/b&gt;

[customrepo]
name=Custom Repo
baseurl=ftp://server.example.local/pub/customrepo
enabled=1
gpgcheck=0
&lt;/pre&gt;

&lt;p&gt;&lt;strong&gt;Update&lt;/strong&gt; the &lt;strong&gt;repository cache&lt;/strong&gt;:&lt;/p&gt;

&lt;div class=&quot;highlighter-rouge&quot;&gt;&lt;div class=&quot;highlight&quot;&gt;&lt;pre class=&quot;highlight&quot;&gt;&lt;code&gt;# yum repolist
&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;</content><author><name></name></author><summary type="html">Install vsftpd (very secure file transfer protocol daemon) and createrepo (tool to create repositories):</summary></entry></feed>